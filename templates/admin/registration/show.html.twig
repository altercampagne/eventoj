{% extends 'admin/_base.html.twig' %}

{% set title = 'Inscription de ' ~ registration.user.fullname ~ ' à ' ~ registration.event.name %}

{% block main %}
    <div class="row">
        <div class="col-8">
            {% if registration.isConfirmed %}
                <div class="alert bg-success-subtle text-success">
                    <i class="fa-solid fa-circle-check me-1"></i> Inscription confirmée le <b>{{ registration.confirmedAt|format_datetime('long', 'short') }}</b>
                </div>
            {% elseif registration.isWaitingPayment %}
                <div class="alert bg-warning-subtle text-secondary">
                    <i class="fa-solid fa-circle-check me-1"></i> Inscription en attente de paiement
                </div>
            {% endif %}

            {% embed 'admin/_cards/registration.html.twig' with { registration: registration } only %}
                {% block content %}
                    {{ parent() }}

                    <ul class="list-group">
                        {% if registration.companions|length > 0 %}
                            <li class="list-group-item">
                                <i class="fa-solid fa-users fa-fw me-1"></i> Companions :
                                <ul>
                                    {% for companion in registration.companions %}
                                        <li>
                                            {{ companion.fullname }} <span class="text-secondary">({{ companion.birthDate|format_date('short') }})</span>
                                        </li>
                                    {% endfor %}
                                </ul>
                            </li>
                        {% endif %}
                    </ul>
                {% endblock %}

                {% block footer %}
                {% endblock %}
            {% endembed %}

            <div class="p-2 text-secondary">
                <small>
                    Créée le <b>{{ registration.createdAt|format_datetime('long', 'short') }}</b>.<br />
                    Dernière mise à jour le <b>{{ registration.updatedAt|format_datetime('long', 'short') }}</b>.
                </small>
            </div>
        </div>

        <div class="col-4 border-start">
            <h3 class="text-center fw-bold"><u>Utilisateurice</u></h3>
            {{ include('admin/_cards/user.html.twig', { user: registration.user }, with_context = false) }}

            <h3 class="text-center fw-bold mt-4"><u>Évènement</u></h3>
            {{ include('admin/_cards/event.html.twig', { event: registration.event }, with_context = false) }}

            {% if registration.approvedPayment is not null %}
                <h3 class="text-center fw-bold mt-4"><u>Paiement</u></h3>
                {{ include('admin/_cards/payment.html.twig', { payment: registration.approvedPayment }, with_context = false) }}
            {% endif %}
        </div>
    </div>
{% endblock %}
